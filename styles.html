<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SuitUp Admin · Styles</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    :root{ --bg:#0f1116; --panel:#171a21; --panel-2:#1c2029; }
    body{ background:var(--bg); color:#e9eef6; }
    .sidebar{ background:var(--panel); min-height:100vh; border-right:1px solid #2a2f3a; position:sticky; top:0; }
    .nav-link{ color:#cfd8e3; }
    .nav-link.active,.nav-link:hover{ color:#fff; background:var(--panel-2); border-radius:.5rem; }
    .card-panel{ background:var(--panel); border:1px solid #2a2f3a; border-radius:.9rem; }
    .kpi{ background:linear-gradient(180deg,var(--panel),var(--panel-2)); border:1px solid #2a2f3a; border-radius:.9rem; padding:1rem 1.25rem; }
    .kpi .value{ font-size:1.75rem; font-weight:700; }
    .searchbar{ background:var(--panel); border:1px solid #2a2f3a; border-radius:.6rem; }
    .style-card{ background:var(--panel-2); border:1px solid #2a2f3a; border-radius:.9rem; overflow:hidden; height:100%; }
    .style-card img{ width:100%; height:150px; object-fit:cover; }
    .style-card .body{ padding:0.9rem; }
    .pill{ border:1px solid #2a2f3a; border-radius:999px; padding:.2rem .55rem; font-size:.78rem; }
    @media (max-width: 991.98px){ .sidebar{ position:static; min-height:auto; } }
  </style>
</head>
<body>

  <div class="container-fluid">
    <div class="row g-0">

      <!-- SIDEBAR -->
      <nav class="col-lg-2 col-md-3 p-3 p-lg-4 sidebar">
        <div class="d-flex align-items-center justify-content-between">
          <div class="d-flex align-items-center gap-2">
            <span class="rounded-circle d-inline-flex align-items-center justify-content-center" style="width:28px;height:28px;background:#2b3240;">
              <i class="bi bi-scissors"></i>
            </span>
            <span class="fw-bold">SuitUp Admin</span>
          </div>
          <button class="btn btn-outline-light d-md-none" data-bs-toggle="collapse" data-bs-target="#sideLinks"><i class="bi bi-list"></i></button>
        </div>

        <div id="sideLinks" class="collapse d-md-block mt-4">
          <ul class="nav flex-column gap-1">
            <li class="nav-item"><a class="nav-link px-3 py-2" href="dashboard.html"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a></li>
            <li class="nav-item"><a class="nav-link px-3 py-2" href="inventory.html"><i class="bi bi-box-seam me-2"></i>Inventory</a></li>
            <li class="nav-item"><a class="nav-link px-3 py-2 active" href="styles.html"><i class="bi bi-rulers me-2"></i>Styles</a></li>
            <li class="nav-item"><a class="nav-link px-3 py-2" href="orders.html"><i class="bi bi-bag-check me-2"></i>Orders</a></li>
            <li class="nav-item"><a class="nav-link px-3 py-2" href="customers.html"><i class="bi bi-people me-2"></i>Customers</a></li>
            <li class="nav-item"><a class="nav-link px-3 py-2" href="settings.html"><i class="bi bi-gear me-2"></i>Settings</a></li>
            <li class="nav-item"><a class="nav-link px-3 py-2" href="crud.html"><i class="bi bi-table me-2"></i>CRUD</a></li>
          </ul>
          <hr class="border-secondary-subtle">
          <a class="btn btn-outline-danger w-100" href="#"><i class="bi bi-box-arrow-right me-2"></i>Logout</a>
        </div>
      </nav>

      <!-- MAIN -->
      <main class="col-lg-10 col-md-9 p-4 p-lg-5">

        <!-- Header -->
        <div class="d-flex flex-wrap align-items-center justify-content-between gap-3 mb-4">
          <div>
            <h1 class="h3 mb-1">Styles</h1>
            <div class="text-secondary">Manage fits, variations, pricing & performance</div>
          </div>
          <div class="d-flex gap-2">
            <div class="input-group searchbar">
              <span class="input-group-text bg-transparent border-0"><i class="bi bi-search"></i></span>
              <input id="search" class="form-control bg-transparent border-0" placeholder="Search styles or SKUs…">
            </div>
            <a class="btn btn-primary" href="crud.html#t_styles"><i class="bi bi-plus-lg me-2"></i>New Style</a>
          </div>
        </div>

        <!-- KPIs -->
        <div class="row g-3 g-lg-4 mb-4">
          <div class="col-6 col-lg-3"><div class="kpi h-100">
            <div class="text-secondary">Active Styles</div>
            <div class="value mt-1" id="kStyles">0</div>
            <div class="small text-secondary">+2 launched this month</div>
          </div></div>
          <div class="col-6 col-lg-3"><div class="kpi h-100">
            <div class="text-secondary">Avg Base Price</div>
            <div class="value mt-1">₹ <span id="kAvgPrice">—</span></div>
            <div class="small text-secondary">before customisations</div>
          </div></div>
          <div class="col-6 col-lg-3"><div class="kpi h-100">
            <div class="text-secondary">Top Fit</div>
            <div class="value mt-1" id="kTopFit">—</div>
            <div class="small text-secondary">share in last 30 days</div>
          </div></div>
          <div class="col-6 col-lg-3"><div class="kpi h-100">
            <div class="text-secondary">Conversion</div>
            <div class="value mt-1">3.8%</div>
            <div class="small text-warning">from style page views</div>
          </div></div>
        </div>

        <!-- Charts -->
        <div class="row g-4 mb-4">
          <div class="col-lg-6">
            <div class="card-panel p-3 p-lg-4">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="h5 mb-0">Fit Distribution</h2>
                <span class="pill">Last 30 days</span>
              </div>
              <canvas id="fitChart" height="180"></canvas>
            </div>
          </div>
          <div class="col-lg-6">
            <div class="card-panel p-3 p-lg-4">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="h5 mb-0">Monthly Demand</h2>
                <span class="pill">This year</span>
              </div>
              <canvas id="trendChart" height="180"></canvas>
            </div>
          </div>
        </div>

        <!-- Filters -->
        <div class="card-panel p-3 p-lg-4 mb-4">
          <div class="row g-2 align-items-end">
            <div class="col-md-3">
              <label class="form-label">Fit</label>
              <select id="fltFit" class="form-select">
                <option value="">All</option>
                <option>Slim</option>
                <option>Classic</option>
                <option>Athletic</option>
                <option>Relaxed</option>
              </select>
            </div>
            <div class="col-md-3">
              <label class="form-label">Buttons</label>
              <select id="fltButtons" class="form-select">
                <option value="">All</option>
                <option>1</option>
                <option>2</option>
                <option>Double-breasted (6)</option>
              </select>
            </div>
            <div class="col-md-3">
              <label class="form-label">Max Base Price (₹)</label>
              <input id="fltPrice" type="number" class="form-control" placeholder="e.g. 30000">
            </div>
            <div class="col-md-3 d-flex gap-2">
              <button id="applyFilters" class="btn btn-primary w-100"><i class="bi bi-funnel me-2"></i>Apply</button>
              <button id="resetFilters" class="btn btn-outline-secondary w-100">Reset</button>
            </div>
          </div>
        </div>

        <!-- Gallery -->
        <div class="row g-3 g-lg-4 mb-4" id="gallery"></div>

        <!-- Catalog Table -->
        <div class="card-panel p-3 p-lg-4">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="h5 mb-0">Style Catalog</h2>
            <button id="exportCsv" class="btn btn-sm btn-outline-secondary"><i class="bi bi-download me-2"></i>Export CSV</button>
          </div>
          <div class="table-responsive">
            <table class="table align-middle" id="styleTable">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Fit</th>
                  <th>Buttons</th>
                  <th>Base Price</th>
                  <th>SKU</th>
                  <th>Status</th>
                  <th></th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

      </main>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // ----- Demo data -----
    const styles = [
      { id:1, name:'Two-piece Suit', fit:'Slim', buttons:'2', price:24990, sku:'ST-2P-SL-02', active:true, img:'https://picsum.photos/seed/style1/800/500' },
      { id:2, name:'Tuxedo', fit:'Classic', buttons:'Double-breasted (6)', price:34990, sku:'ST-TX-CL-06', active:true, img:'https://picsum.photos/seed/style2/800/500' },
      { id:3, name:'Three-piece Suit', fit:'Athletic', buttons:'2', price:29990, sku:'ST-3P-AT-02', active:true, img:'https://picsum.photos/seed/style3/800/500' },
      { id:4, name:'Casual Blazer', fit:'Relaxed', buttons:'2', price:18990, sku:'ST-BL-RL-02', active:false, img:'https://picsum.photos/seed/style4/800/500' },
      { id:5, name:'Shawl Lapel Tux', fit:'Slim', buttons:'1', price:32990, sku:'ST-TX-SL-01', active:true, img:'https://picsum.photos/seed/style5/800/500' },
      { id:6, name:'Double-Breasted Suit', fit:'Classic', buttons:'Double-breasted (6)', price:31990, sku:'ST-DB-CL-06', active:true, img:'https://picsum.photos/seed/style6/800/500' }
    ];

    // ----- KPIs -----
    function computeKPIs(list){
      document.getElementById('kStyles').textContent = list.length;
      const avg = Math.round(list.reduce((s,r)=>s+r.price,0)/list.length);
      document.getElementById('kAvgPrice').textContent = avg.toLocaleString('en-IN');
      const fitCounts = list.reduce((m,r)=> (m[r.fit]=(m[r.fit]||0)+1, m), {});
      let topFit='—', topVal=-1;
      for(const [f,c] of Object.entries(fitCounts)){ if(c>topVal){ topVal=c; topFit=f; } }
      document.getElementById('kTopFit').textContent = `${topFit} (${Math.round((topVal/list.length)*100)}%)`;
    }

    // ----- Gallery & Table rendering -----
    function render(list){
      // gallery
      const g = document.getElementById('gallery'); g.innerHTML = '';
      list.forEach(s=>{
        const col = document.createElement('div'); col.className='col-12 col-md-6 col-xl-4';
        col.innerHTML = `
          <div class="style-card">
            <img src="${s.img}" alt="">
            <div class="body">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <div class="fw-semibold">${s.name}</div>
                  <div class="text-secondary small">${s.fit} • ${s.buttons}</div>
                </div>
                <span class="badge ${s.active?'text-bg-success':'text-bg-secondary'}">${s.active?'Active':'Hidden'}</span>
              </div>
              <div class="d-flex justify-content-between align-items-center mt-2">
                <div class="fw-bold">₹ ${s.price.toLocaleString('en-IN')}</div>
                <a class="btn btn-sm btn-outline-light" href="crud.html#t_styles"><i class="bi bi-pencil me-1"></i>Edit</a>
              </div>
            </div>
          </div>`;
        g.appendChild(col);
      });

      // table
      const tb = document.querySelector('#styleTable tbody'); tb.innerHTML = '';
      list.forEach(s=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${s.name}</td>
          <td>${s.fit}</td>
          <td>${s.buttons}</td>
          <td>₹ ${s.price.toLocaleString('en-IN')}</td>
          <td>${s.sku}</td>
          <td><span class="badge ${s.active?'text-bg-success':'text-bg-secondary'}">${s.active?'Active':'Hidden'}</span></td>
          <td><a class="btn btn-sm btn-outline-light" href="crud.html#t_styles">Edit</a></td>`;
        tb.appendChild(tr);
      });
      computeKPIs(list);
    }

    // ----- Filters -----
    function applyFilters(){
      const q = document.getElementById('search').value.toLowerCase();
      const fit = document.getElementById('fltFit').value;
      const btns = document.getElementById('fltButtons').value;
      const price = Number(document.getElementById('fltPrice').value || Infinity);

      const filtered = styles.filter(s =>
        (s.name.toLowerCase().includes(q) || s.sku.toLowerCase().includes(q)) &&
        (fit ? s.fit===fit : true) &&
        (btns ? s.buttons===btns : true) &&
        (s.price <= price)
      );
      render(filtered);
      updateCharts(filtered);
    }

    function resetFilters(){
      document.getElementById('search').value='';
      document.getElementById('fltFit').value='';
      document.getElementById('fltButtons').value='';
      document.getElementById('fltPrice').value='';
      render(styles);
      updateCharts(styles);
    }

    document.getElementById('applyFilters').addEventListener('click', applyFilters);
    document.getElementById('resetFilters').addEventListener('click', resetFilters);
    document.getElementById('search').addEventListener('input', applyFilters);

    // ----- Charts -----
    let fitChart, trendChart;
    function buildCharts(){
      const fc = document.getElementById('fitChart');
      const tc = document.getElementById('trendChart');
      fitChart = new Chart(fc, {
        type:'doughnut',
        data:{ labels:['Slim','Classic','Athletic','Relaxed'],
          datasets:[{ data:[42,28,18,12] }]},
        options:{ plugins:{ legend:{ position:'bottom' } } }
      });
      trendChart = new Chart(tc, {
        type:'line',
        data:{
          labels:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],
          datasets:[
            { label:'Orders', data:[38,42,55,61,70,76,85,92,88,95,101,110], tension:.35, fill:false },
            { label:'Views (×10)', data:[220,240,260,300,340,370,390,420,410,450,470,520], tension:.35, fill:false }
          ]},
        options:{ plugins:{ legend:{ position:'bottom' } }, scales:{ y:{ beginAtZero:true } } }
      });
    }

    function updateCharts(list){
      // recompute fit distribution from filtered list
      const fits=['Slim','Classic','Athletic','Relaxed'];
      const counts=fits.map(f=> list.filter(s=>s.fit===f).length );
      fitChart.data.datasets[0].data = counts.map(c=> c || 0);
      fitChart.update();
      // keep trend as static demo; could be tied to list later
    }

    // ----- Export CSV -----
    document.getElementById('exportCsv').addEventListener('click', ()=>{
      const rows = [['Name','Fit','Buttons','Base Price','SKU','Status']];
      document.querySelectorAll('#styleTable tbody tr').forEach(tr=>{
        const cols = [...tr.children].slice(0,6).map(td=>td.innerText.replace(/₹\s?/,''));
        rows.push(cols);
      });
      const csv = rows.map(r=>r.join(',')).join('\n');
      const blob = new Blob([csv], {type:'text/csv'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'styles_catalog.csv';
      a.click(); URL.revokeObjectURL(a.href);
    });

    // ----- Init -----
    buildCharts();
    render(styles);
    updateCharts(styles);
  </script>
</body>
</html>
